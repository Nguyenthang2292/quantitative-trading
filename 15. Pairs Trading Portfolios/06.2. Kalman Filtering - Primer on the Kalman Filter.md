# Primer on the Kalman Filter
Mô hình không gian trạng thái và Bộ lọc Kalman

Mô hình không gian trạng thái (State-space modeling) cung cấp một khung thống nhất để xử lý nhiều loại vấn đề trong phân tích chuỗi thời gian. Nó có thể được coi là một mô hình phổ quát và linh hoạt, với một thuật toán rất hiệu quả là bộ lọc Kalman (Kalman filter). Ý tưởng cơ bản là ước tính sự tiến hóa của hệ thống theo thời gian, được thúc đẩy bởi một loạt các giá trị chưa quan sát hoặc giá trị ẩn, mà chỉ có thể được đo lường gián tiếp thông qua các quan sát từ đầu ra của hệ thống. Mô hình này có thể được sử dụng để lọc, làm mượt và dự báo. Chi tiết hơn về mô hình không gian trạng thái và bộ lọc Kalman có thể được tìm thấy trong Mục 4.2 của Chương 4.
Bộ lọc Kalman, được NASA sử dụng trong chương trình Apollo vào những năm 1960, hiện nay đã có rất nhiều ứng dụng công nghệ. Nó thường được sử dụng trong dẫn đường, định vị và điều khiển của các phương tiện như máy bay, tàu vũ trụ và tàu biển. Bộ lọc này cũng được ứng dụng rộng rãi trong phân tích chuỗi thời gian, xử lý tín hiệu và kinh tế lượng. Gần đây, nó đã trở thành một thành phần chính trong việc lập kế hoạch và kiểm soát robot, cũng như tối ưu hóa quỹ đạo.
Mô hình không gian trạng thái và bộ lọc Kalman đã trưởng thành, với nhiều sách giáo khoa xuất sắc có sẵn như các tài liệu kinh điển của B. D. O. Anderson và Moore (1979), Durbin và Koopman (2012). Một số tài liệu tham khảo khác bao gồm Brockwell và Davis (2002), Shumway và Stoffer (2017), A. Harvey (1989), và đặc biệt trong chuỗi thời gian tài chính như Zivot et al. (2004), Tsay (2010), Lütkepohl (2007), và Koopman (2009).**

### Mô hình toán học của Bộ lọc Kalman
Về mặt toán học, bộ lọc Kalman dựa trên mô hình không gian trạng thái tuyến tính Gaussian với thời gian rời rạc $t = 1, \dots, T$ (Durbin và Koopman, 2012):

$$y_t = Z_t \alpha_t + \epsilon_t \quad (\text{phương trình quan sát}),$$

$$\alpha_{t+1} = T_t \alpha_t + \eta_t \quad (\text{phương trình trạng thái}),$$

#### Trong đó:
- $y_t$: Quan sát qua thời gian.
- $Z_t$: Ma trận quan sát.
- $\alpha_t$: Trạng thái ẩn hoặc chưa quan sát được của hệ thống.
- $T_t$: Ma trận chuyển tiếp trạng thái.
- $\epsilon_t$ và $\eta_t$: Các nhiễu Gaussian với giá trị trung bình bằng 0 và ma trận hiệp phương sai lần lượt là $H$ và $Q$:

$$\epsilon_t \sim \mathcal{N}(0, H), \quad \eta_t \sim \mathcal{N}(0, Q).$$

- Trạng thái ban đầu $\alpha_1$ có thể được mô hình hóa như:

$$\alpha_1 \sim \mathcal{N}(\alpha_1, P_1).$$

#### Ghi chú:
- Các tham số của mô hình không gian trạng thái ($Z_t, T_t, H, Q, \alpha_1, P_1$) có thể được người dùng cung cấp (nếu biết) hoặc được suy ra từ dữ liệu với các thuật toán tối đa hóa độ khả năng hợp lý (maximum likelihood estimation).

### Ý nghĩa và ứng dụng của Bộ lọc Kalman:
1. **Tối ưu hóa phân phối trạng thái ẩn:**
   - Bộ lọc Kalman là một thuật toán hiệu quả để mô tả tối ưu phân phối của trạng thái ẩn tại thời điểm $t$, $\alpha_t$, theo cách nhân quả.
   - Cụ thể:
     - $\alpha_{t+1|t}$: Trạng thái dự đoán tại thời điểm $t + 1$ dựa trên các quan sát từ $t$ trở về trước.
     - $\alpha_{t|t}$: Trạng thái ước tính tại thời điểm $t$.
   - Các giá trị này có thể được tính toán hiệu quả thông qua quy trình "đi tới" (forward pass) từ $t = 1$ đến $T$.

2. **Ứng dụng thực tế:**
   - Bộ lọc Kalman không chỉ được sử dụng trong mô hình hóa chuỗi thời gian mà còn trong các bài toán điều khiển thời gian thực.

### Kết luận:
- **Mô hình không gian trạng thái** cung cấp một cách tiếp cận linh hoạt để xử lý chuỗi thời gian phức tạp.
- Bộ lọc Kalman là một công cụ mạnh mẽ và hiệu quả để ước tính trạng thái ẩn của hệ thống, đặc biệt trong các ứng dụng thời gian thực như tài chính, kinh tế lượng, và kỹ thuật điều khiển.
